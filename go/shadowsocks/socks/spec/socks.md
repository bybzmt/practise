# SOCKS5

## 握手请求

|VER | NMETHODS | METHODS  |
|----|----------|----------|
| 1  |    1     | 1 to 255 |

- VER：协议版本（SOCKS5 固定为 0x05）。
- NMETHODS：支持的认证方法数量（如 0x02 表示两种方法）。
- METHODS：具体方法列表（常见值）：
    * 0x00：无需认证（匿名代理）。
    * 0x01：GSSAPI（用于企业级身份验证）。
    * 0x02：用户名/密码认证（需后续校验）。
    * 0xFF：无支持方法（连接终止）。

## 握手响应

|VER | METHOD |
|----|--------|
| 1  |   1    |

## 认证阶段

|VER | ULEN |  UNAME   | PLEN |  PASSWD  |
|----|------|----------|------|----------|
| 1  |  1   | 1 to 255 |  1   | 1 to 255 |

VER 认证子协议版本，固定为 0x01

## 认证响应

|VER | STATUS |
|----|--------|
| 1  |   1    |

VER 认证子协议版本

## 代理请求

|VER | CMD |  RSV  | ATYP | DST.ADDR | DST.PORT |
|----|-----|-------|------|----------|----------|
| 1  |  1  | 0x00  |  1   | Variable |    2     |

- CMD：请求类型：
    * 0x01：CONNECT（建立 TCP 连接）。
    * 0x02：BIND（反向代理，如 FTP）。
    * 0x03：UDP 转发。

- ATYP：目标地址类型：
    * 0x01：IPv4（4 字节）。
    * 0x03：域名（首字节为长度，后接域名）。
    * 0x04：IPv6（16 字节）。

- DST.ADDR/DST.PORT：目标地址和端口（网络字节序）。

## 代理响应

|VER | REP |  RSV  | ATYP | BND.ADDR | BND.PORT |
|----|-----|-------|------|----------|----------|
| 1  |  1  | 0x00  |  1   | Variable |    2     |

REP：状态码：

* 0x00：成功。
* 0x01：常规错误。
* 0x02：规则禁止连接。
* 0x03：网络不可达。
* 0x04：主机不可达。
* 0x05：连接拒绝。
* 0x07：TTL 过期（如 ICMP 触发）。
* 0x08：地址类型不支持。
